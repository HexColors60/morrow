---
# Base Entities used throughout the system.  Any Entity may be used as the base
# for another Entity, these are just the most generic among them.
- id: base:room
  components:
  - environment
  - viewable:
      format: room
      short: An indescribable room
      desc: |-
        There is space here.

- id: base:template
  components:
  - view_exempt

- id: base:char
  base: base:template
  components:
  - keywords:
    - [ char ]
  - viewable:
      format: character
      short: a non-descript character
      long: |-
        You see nothing special about them.

- id: base:obj
  base: base:template
  components:
  - keywords:
    - [ obj ]
  - viewable:
      format: object
      short: an object
      long: You see nothing special...

- id: base:room/void
  base: base:room
  components:
  - viewable:
      short: The Void
      desc: You are floating in nothing

- id: base:player
  base: base:char
  components:
  - player_config
  - connection
  - command_queue

- id: base:race/human
  base: base:char
  components:
  - viewable:
      short: a human

- id: base:race/elf
  base: base:char
  components:
  - viewable:
      short: an elf
  - affect: [ attributes, strength, modify, -2 ]
  - affect: [ attributes, dexterity, modify, 1 ]
  - affect: [ attributes, wisdon, modify, 1 ]

- id: base:exit
  components:
  - viewable:
      format: exit
      desc: You see nothing special...
  - destination:

- id: base:door/closed
  base: base:exit
  components:
  - keywords:
    - [ door ]
  - viewable:
      format: object
      short: a door
      desc: A wooden door bars your way.

- id: base:obj/bag/small
  base: base:obj
  components:
  - keywords:
    - [ small, bag ]
  - viewable:
      short: a small bag
      long: a small bag is here, collecting dust
  - container:
      max_volume: 10
  - closable

- id: base:obj/chest/wooden
  base: base:obj
  components:
  - keywords:
    - [ wooden, chest ]
  - viewable:
      short: a wooden chest
      long: a wooden chest rests on the floor
  - container:
      max_volume: 100
  - closable

- id: base:obj/junk/ball
  base: base:obj
  components:
  - keywords:
    - [red, rubber, ball]
  - viewable:
      short: a red rubber ball
      long: a red rubber ball is on the floor

- id: base:act/teleporter
  components:
  - hook:
      event: :on_enter
      script: base:script/teleporter/enter
  - hook:
      event: :on_exit
      script: base:script/teleporter/exit
  - teleporter

- id: base:script/teleporter/enter
  components:
  - script: !script |
      here = args[:here]
      unless porter = get_component(here, :teleporter)
        error "#{here} missing teleporter component"
        return
      end
      entity = args[:entity]
      port = get_component!(entity, :teleport)
      port[:dest] = porter[:dest]
      port[:time] = now + porter[:delay]

- id: base:script/teleporter/exit
  components:
  - script: !script |
      remove_component(args[:entity], :teleport)
